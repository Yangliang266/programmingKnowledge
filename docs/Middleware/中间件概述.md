###  什么是中间件

> 服务于操作系统之上于业务程序之下



### 中间件之消息队列

> 消息队列，即消息中间件，以看作是一个中介收发消息

> 用高效可靠的消息传递机制进行与平台无关的数据交流，基于数据通信进行分布式系统的集成

> 消息中间件的出现是为了提供容错机制，相当于缓冲区域，比如elk中需要kafka这样的消息队列作为缓冲，直接打到es的话，es会扛不住。logstash没秒吐出超过8000的时候 就不能保证时效性了，你可以起多台logstash 去吞吐 这时候需要Kafka来保证多logstash不拿重复。而且一般遇到一些系统上的尖峰，瞬时的体量是平时几倍或者几十倍。而且缓存层 也便于不同部门之间的协作管理

#### 解决的问题

- 异步通信

  > 当一个调用者发出请求后，不会立即得到结果，被调用者通过状态，通知来告知调用者或者通过回调函数来处理这个调用

- 解耦

  > 使得各 个子系统之间的耦合性大大降低，各个系统由原来的流水式转变为散列式，MQ作为中间件通过收集生产者的消息，派发给各个消费者大大提高了性能

- 削峰

  > 由于quque的特性，先进先出，所以不管需要处理的请求量有多大，消费者都会按照顺序进行处理，同时也可以创建多个消费者加快处理的效率

#### rabbit/kafka/rocket对比

- rabbit由于master queue单节点，导致性能瓶颈，吞吐量受限。虽然为了提高性能，内部使用了Erlang这个语言实现，但是终究摆脱不了架构设计上的致命缺陷

- kafka的批量消息发送机制以及一个topic多个分区支持高并发提高吞吐量，通过副本机制保证分区高可用

- rocket

  

  <img src="https://yliang.oss-cn-shanghai.aliyuncs.com/img/programming/20190604163721276.png" alt="img"  />
  
  



### 中间件之数据库中间件

跑批程序

